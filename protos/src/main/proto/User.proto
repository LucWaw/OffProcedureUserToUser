syntax = "proto3";

package utou.v1;

option java_multiple_files = true;
option java_outer_classname = "UserProto";
option java_package = "fr.lucwaw.utou.user";

import "common.proto";

// User service: create/list users and manage device tokens (FCM)
service UserService {
  rpc CreateUser(CreateUserRequest) returns (CreateUserResponse) {}
  rpc ListUsers(ListUsersRequest) returns (ListUsersResponse) {}

  // Register/update a device token for push notifications (FCM token)
  rpc RegisterDevice(RegisterDeviceRequest) returns (RegisterDeviceResponse) {}
}

// Create user
message CreateUserRequest {
  reserved 1;                 // client or server generated; prefer server-generated UUID
  reserved 2;                // unique username (optional)
  string display_name = 3;            // display name
}

message CreateUserResponse {
  StatusCode status = 1;
  GrpcUser user = 2;
  string message = 3;
}

// List users
message ListUsersRequest {}

message GrpcUser {
  string user_GUID = 1;
  reserved 2;
  string display_name = 3;
  int64 updatedAt = 4;
}

message ListUsersResponse {
  repeated GrpcUser users = 1;
}

// Device token management (for FCM)
message RegisterDeviceRequest {
  string user_id = 1;
  reserved 2;    // client device id (optional but useful)
  string fcm_token = 3;    // token received from FCM SDK
}

message RegisterDeviceResponse {
  StatusCode status = 1;
  string message = 2;
}
